"""
Takes input a JSON from user which has base64 encoded image.
"""

import base64
import numpy as np
from io import BytesIO
from PIL import Image
import cv2
import tensorflow as tf


# Get JSON
bse = b"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"
image_binary = base64.b64decode(bse)
# image_binary = BytesIO(image_binary)

image_pil = Image.open(BytesIO(image_binary))
rgb_image = image_pil.convert('RGB')
image_array = np.array(rgb_image)
print(image_array.shape)

# Resize image for inceptionV3
image_array = cv2.resize(image_array, (299, 299), interpolation=cv2.INTER_AREA)
print(image_array.shape)


# Load encoder and decoder for the model
# encoder = tf.keras.load_weights('captionit-encoder-baseline.h5')
# decoder = tf.keras.load_weights('captionit-decoder-baseline.h5')

# Load feature extraction model


# image_features_extract_model = tf.keras.models.load_model('image_features_extract_model.h5', compile=False)

def generate_caption(image):

    hidden = decoder.reset_state(batch_size=1)

    # Extract image features from InceptionV3
    img_tensor_val = image_features_extract_model(image)
    img_tensor_val = tf.reshape(img_tensor_val, (img_tensor_val.shape[0], -1, img_tensor_val.shape[3]))

    features = encoder(img_tensor_val)


def handle_request(event, context):
    return {}